PEP: 9999
Title: Disabling bdist_egg distribution uploads on PyPI
Author: William Woodruff <william@yossarian.net>
Sponsor: Donald Stufft <donald@stufft.io>
PEP-Delegate: Donald Stufft <donald@stufft.io>
Status: Draft
Type: Process
Topic: Packaging
Content-Type: text/x-rst
Created: 06-Jun-2023
Post-History:
Resolution:

Abstract
========

This PEP recommends deprecating and then disabling new uploads of the
``bdist_egg`` distribution type on PyPI. In a parallel move, this PEP recommends
deprecating and then disabling new uploads of distribution filenames that have
the ``.egg`` suffix.

It does not recommend removing or otherwise affecting any previously
uploaded ``bdist_egg`` distributions or files with the ``.egg`` suffix.

Rationale
=========

Previous Work
-------------

The groundwork for this proposal was established with :pep:`527`, which
proposed deprecating and eventually removing upload support for a handful
of un(der)used file extensions and distribution types.

In particular, :pep:`527` proposed the removal of the ``bdist_dumb``,
``bdist_rpm``, ``bdist_dmg``, ``bdist_msi``, and ``bdist_wininst`` distribution
types, as well as the ``.tar``, ``.tar.bz2``, ``.tar.xz``, ``.tar.Z``,
``.tgz``, and ``.tbz`` file extensions on distribution filenames.

:pep:`527` was fully enacted with
`PR #7529 <https://github.com/pypi/warehouse/pull/7529>`_ to Warehouse,
which was merged on 13 April 2020.

The ``bdist_egg`` format
------------------------

The ``bdist_egg`` filetype identifies distributions in the
:term:`egg format <packaging:Egg>`. The
egg format was introduced by setuptools in 2004 and is roughly equivalent
in functionality to the
:term:`wheel format <packaging:Wheel>`
first introduced by :pep:`427` in 2012 as the standardized
:ref:`built distribution format <packaging:binary-distribution-format>`.

Despite its longevity, the egg format has had
`limited adoption on PyPI <https://github.com/pypi/warehouse/issues/10653>`_.
Some observations from that issue:

* In the month of May 2023, ``bdist_egg`` uploads accounted for 0.2% of all
  distribution uploads to PyPI;
* ``pip`` deprecated its ``--egg`` option in 2016;
* ``setuptools`` has considered egg support deprecated since 2019;
* ``build`` only supports the ``sdist`` and ``bdist_wheel`` filetypes.

Given the above, this PEP proposes the removal of the ``bdist_egg`` format
under the same justifications presented in :pep:`527`, namely:

* egg distributions are of of limited use to the broader ecosystem and
  therefore represent a non-reciprocal maintenance burden;
* Continued support for egg distributions represents a bandwidth and storage
  cost to PyPI, as well as to any external mirrors of PyPI.

This PEP *additionally* offers an argument for removal rooted in
standardization and duplication: the egg format is not standardized by any
PEP or other community standard, and overlaps heavily with its standardized
and well-supported alternative (wheel).

The ``.egg`` file extension
---------------------------

The ``.egg`` file extension is used exclusively for distributions of the
``bdist_egg`` format. As such, it serves no purpose in a scenario where
PyPI disables new distribution uploads for ``bdist_egg`` distributions.

Removal Process
===============

This PEP does **NOT** propose removing any existing files from PyPI, only
disallowing new ones from being uploaded. This restriction will be phased in on
a per-project basis to allow projects to adjust to the new restrictions where
applicable.

First, any *existing* projects will be flagged to allow legacy file types to be
uploaded, and any project without that flag (i.e. new projects) will not be
able to upload anything but ``sdist`` with a ``.tar.gz`` or ``.zip`` extension,
or a ``bdist_wheel`` with a ``.whl`` extension. Then, any existing projects
that have never uploaded a file that requires the legacy file type flag will
have that flag removed, also making them fall under the new restrictions.
Finally, an email will be generated to the maintainers of all projects still
given the legacy flag, which will inform them of the upcoming new restrictions
on uploads and tell them that these restrictions will be applied to future
uploads to their projects starting in 1 month. Finally, after 1 month all
projects will have the legacy file type flag removed, and support for uploading
these types of files will cease to exist on PyPI.

Prior Art
---------

The removal process above is based on :pep:`527`'s removal process. However,
only the process above is authoritative for this PEP.

Backwards Compatibility
=======================

Limited Impact
--------------

As noted in the rationale section, this PEP is expected to have no impact
on the overwhelming majority of PyPI users.

Hosted Files
------------

This PEP does **NOT** propose the removal of any egg distributions that have
already been uploaded to PyPI. All previously uploaded egg distributions will
remain downloadable, ensuring that existing users will continue to be able
to download them.

Deprecation Period
------------------

This PEP uses the removal process documented above, which specifies
a deprecation period of 1 month for projects that have previously uploaded
egg distributions to PyPI.

After the end of the deprecation period, support for uploading new egg
distributions will cease to exist on PyPI.

Security Implications
=====================

This PEP does not identify any positive or negative security implications
associated with removing upload support for egg distributions.

How To Teach This
=================

As part of the removal process, PyPI will send emails to all maintainers of
projects who have previously uploaded egg distributions.

Additionally, PyPI will write a post on the
`PyPI blog <https://blog.pypi.org/>`_ that publicly announces the deprecation
period's start and end.

Copyright
=========

This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.
